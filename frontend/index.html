<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Restaurant Recommendation</title>
  </head>
  <body>
    <h1>Restaurant Recommendation...</h1>

    <label>Favorite meal in which restaurant:</label>
    <input id="meal" placeholder="pizza / shawarma / burger" />
    <button onclick="go()">Recommend....</button>

    <pre id="out"></pre>

    <script>
      async function go() {
        const meal = document.getElementById("meal").value.trim().toLowerCase();
        const out = document.getElementById("out");

        if (!meal) {
          out.textContent = "Please enter a meal (pizza / shawarma / burger).";
          return;
        }

        out.textContent = "Loading...";

        try {
          const res = await fetch(`/api/recommend?meal=${encodeURIComponent(meal)}`);
          const text = await res.text();

          if (!res.ok) {
            out.textContent = `HTTP ERROR ${res.status}\n${text}`;
            return;
          }

          try {
            const data = JSON.parse(text);
            if (data.found && data.restaurant?.name) {
              out.textContent = `üçΩ Recommended restaurant: ${data.restaurant.name}\n‚≠ê Rating: ${data.restaurant.rating}`;
            } else {
              out.textContent = data.message || text;
            }
          } catch {
            out.textContent = text;
          }

        } catch (err) {
          out.textContent = `Request failed: ${err.message}`;
        }
      }
    </script>
  </body>
</html>
